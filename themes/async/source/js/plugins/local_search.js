(()=>{var y=(()=>{let n=null;return()=>{if(!!LocalSearch){if(!n){let{search:r,root:u}=window.ASYNC_CONFIG;n=new LocalSearch({path:u+r.path,top_n_per_article:r.top_n_per_article,unescape:r.unescape})}return n}}})();function L(){let{search:n,i18n:r}=window.ASYNC_CONFIG;if(n){if(!n.path){console.warn("`hexo-generator-searchdb` plugin is not installed!");return}let u=document.querySelector("#trm-search-btn"),d=document.querySelector(".trm-search-btn-close"),c=document.querySelector(".trm-search-input"),o=y();n.preload&&!o.isfetched&&o.fetchData();let a=()=>{if(!o.isfetched)return;let e=c.value.trim().toLowerCase(),w=e.split(/[-\s]+/),v=document.querySelector(".trm-search-result-container"),f=document.querySelector(".trm-search-stats"),s=[];if(e.length>0&&(s=o.getResultItems(w)),s.length>0)s.sort((t,i)=>t.includedCount!==i.includedCount?i.includedCount-t.includedCount:t.hitCount!==i.hitCount?i.hitCount-t.hitCount:i.id-t.id),v.innerHTML=`<ul class="search-result-list">${s.map(t=>t.item).join("")}</ul>`,f.innerHTML=r.hits.replace(/\$\{hits}/,s.length.toString());else{let t=r.empty.replace(/\$\{query}/,e);v.innerHTML=`<div class="trm-search-empty">${t}</div>`,f.innerHTML=""}},p=()=>{document.querySelector(".trm-search-popup").classList.toggle("show"),setTimeout(()=>c.focus(),500),o.isfetched||o.fetchData()},l=function(){document.querySelector(".trm-search-popup").classList.toggle("show")},h=function(e){e.key==="Escape"&&(l(),e.preventDefault(),e.stopPropagation())},m=function(e){e.key==="Enter"&&a()};n.trigger==="auto"?c.addEventListener("input",a):c.addEventListener("keypress",m),d.addEventListener("click",l),u.addEventListener("click",p),window.addEventListener("keydown",h),document.addEventListener("swup:contentReplaced",e=>{u.removeEventListener("click",p),d.removeEventListener("click",l),c.removeEventListener("input",a),c.removeEventListener("keypress",m),window.removeEventListener("keydown",h)})}}L();window.ASYNC_CONFIG.swup&&document.addEventListener("swup:contentReplaced",function(){L()});})();
